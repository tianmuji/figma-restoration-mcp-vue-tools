<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»„ä»¶è¿˜åŸåº¦å¯¹æ¯”ç³»ç»Ÿæµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f9fafb;
            color: #1f2937;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 10px;
        }
        
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .test-section h2 {
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 15px;
        }
        
        .test-button {
            padding: 10px 20px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: background 0.2s;
        }
        
        .test-button:hover {
            background: #2563eb;
        }
        
        .test-button.secondary {
            background: #6b7280;
        }
        
        .test-button.secondary:hover {
            background: #4b5563;
        }
        
        .result-area {
            margin-top: 20px;
            padding: 15px;
            background: #f9fafb;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            min-height: 100px;
            white-space: pre-wrap;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
        }
        
        .status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status.success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status.error {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .status.warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .component-card {
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .component-card h3 {
            margin-bottom: 10px;
            color: #1f2937;
        }
        
        .component-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
            font-size: 14px;
        }
        
        .loading {
            color: #6b7280;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ ç»„ä»¶è¿˜åŸåº¦å¯¹æ¯”ç³»ç»Ÿæµ‹è¯•</h1>
            <p>æµ‹è¯•æ•°æ®æœåŠ¡å’Œç»„ä»¶åŠŸèƒ½</p>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š æ•°æ®æœåŠ¡æµ‹è¯•</h2>
            <button class="test-button" onclick="testComponentsSummary()">æµ‹è¯•ç»„ä»¶æ±‡æ€»</button>
            <button class="test-button" onclick="testSystemStats()">æµ‹è¯•ç³»ç»Ÿç»Ÿè®¡</button>
            <button class="test-button" onclick="testDesignV1Report()">æµ‹è¯• DesignV1 æŠ¥å‘Š</button>
            <!-- HelloWorld æµ‹è¯•æŒ‰é’®å·²ç§»é™¤ -->
            <button class="test-button secondary" onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
            <div id="dataResults" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
        </div>

        <div class="test-section">
            <h2>ğŸ–¼ï¸ å›¾ç‰‡èµ„æºæµ‹è¯•</h2>
            <button class="test-button" onclick="testImageAccess()">æµ‹è¯•å›¾ç‰‡è®¿é—®</button>
            <button class="test-button" onclick="testReportFiles()">æµ‹è¯•æŠ¥å‘Šæ–‡ä»¶</button>
            <div id="imageResults" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
        </div>

        <div class="test-section">
            <h2>ğŸ“‹ ç»„ä»¶åˆ—è¡¨é¢„è§ˆ</h2>
            <button class="test-button" onclick="loadComponentsPreview()">åŠ è½½ç»„ä»¶é¢„è§ˆ</button>
            <div id="componentsPreview" class="component-grid">
                <div class="loading">ç‚¹å‡»æŒ‰é’®åŠ è½½ç»„ä»¶æ•°æ®...</div>
            </div>
        </div>
    </div>

    <script type="module">
        // å¯¼å…¥æ•°æ®æœåŠ¡
        import { ComparisonDataService } from './services/comparison-data-service.js';
        
        const dataService = new ComparisonDataService();
        
        // å…¨å±€å‡½æ•°
        window.testComponentsSummary = async function() {
            const resultArea = document.getElementById('dataResults');
            resultArea.textContent = 'æ­£åœ¨åŠ è½½ç»„ä»¶æ±‡æ€»æ•°æ®...';
            
            try {
                const summary = await dataService.getComponentsSummary();
                resultArea.textContent = `âœ… ç»„ä»¶æ±‡æ€»åŠ è½½æˆåŠŸï¼\n\n${JSON.stringify(summary, null, 2)}`;
            } catch (error) {
                resultArea.textContent = `âŒ åŠ è½½å¤±è´¥: ${error.message}`;
            }
        };
        
        window.testSystemStats = async function() {
            const resultArea = document.getElementById('dataResults');
            resultArea.textContent = 'æ­£åœ¨åŠ è½½ç³»ç»Ÿç»Ÿè®¡æ•°æ®...';
            
            try {
                const stats = await dataService.getSystemStats();
                resultArea.textContent = `âœ… ç³»ç»Ÿç»Ÿè®¡åŠ è½½æˆåŠŸï¼\n\n${JSON.stringify(stats, null, 2)}`;
            } catch (error) {
                resultArea.textContent = `âŒ åŠ è½½å¤±è´¥: ${error.message}`;
            }
        };
        
        window.testDesignV1Report = async function() {
            const resultArea = document.getElementById('dataResults');
            resultArea.textContent = 'æ­£åœ¨åŠ è½½ DesignV1 æŠ¥å‘Š...';
            
            try {
                const report = await dataService.getComparisonReport('DesignV1');
                resultArea.textContent = `âœ… DesignV1 æŠ¥å‘ŠåŠ è½½æˆåŠŸï¼\n\nç»„ä»¶: ${report.componentName}\nè¿˜åŸåº¦: ${report.summary.matchPercentage.toFixed(2)}%\nçŠ¶æ€: ${report.summary.status}\né—®é¢˜æ•°: ${report.summary.totalIssues}\n\nå®Œæ•´æ•°æ®:\n${JSON.stringify(report, null, 2)}`;
            } catch (error) {
                resultArea.textContent = `âŒ åŠ è½½å¤±è´¥: ${error.message}`;
            }
        };
        
        // HelloWorld æµ‹è¯•å·²ç§»é™¤
        
        window.testImageAccess = async function() {
            const resultArea = document.getElementById('imageResults');
            resultArea.textContent = 'æ­£åœ¨æµ‹è¯•å›¾ç‰‡è®¿é—®...';
            
            const imagePaths = [
                '/src/components/DesignV1/results/expected.png',
                '/src/components/DesignV1/results/actual.png',
                '/src/components/DesignV1/results/diff.png',
                '/src/components/DesignV1/results/heatmap.png'
            ];
            
            let results = 'å›¾ç‰‡è®¿é—®æµ‹è¯•ç»“æœ:\n\n';
            
            for (const path of imagePaths) {
                try {
                    const response = await fetch(path);
                    if (response.ok) {
                        results += `âœ… ${path} - å¯è®¿é—® (${response.status})\n`;
                    } else {
                        results += `âŒ ${path} - æ— æ³•è®¿é—® (${response.status})\n`;
                    }
                } catch (error) {
                    results += `âŒ ${path} - è®¿é—®é”™è¯¯: ${error.message}\n`;
                }
            }
            
            resultArea.textContent = results;
        };
        
        window.testReportFiles = async function() {
            const resultArea = document.getElementById('imageResults');
            resultArea.textContent = 'æ­£åœ¨æµ‹è¯•æŠ¥å‘Šæ–‡ä»¶è®¿é—®...';
            
            const reportPaths = [
                '/src/components/DesignV1/results/comparison-report.json'
            ];
            
            let results = 'æŠ¥å‘Šæ–‡ä»¶è®¿é—®æµ‹è¯•ç»“æœ:\n\n';
            
            for (const path of reportPaths) {
                try {
                    const response = await fetch(path);
                    if (response.ok) {
                        const data = await response.json();
                        results += `âœ… ${path} - å¯è®¿é—®ï¼Œç»„ä»¶: ${data.componentName}, è¿˜åŸåº¦: ${data.summary?.matchPercentage?.toFixed(2) || 'N/A'}%\n`;
                    } else {
                        results += `âŒ ${path} - æ— æ³•è®¿é—® (${response.status})\n`;
                    }
                } catch (error) {
                    results += `âŒ ${path} - è®¿é—®é”™è¯¯: ${error.message}\n`;
                }
            }
            
            resultArea.textContent = results;
        };
        
        window.loadComponentsPreview = async function() {
            const previewArea = document.getElementById('componentsPreview');
            previewArea.innerHTML = '<div class="loading">æ­£åœ¨åŠ è½½ç»„ä»¶æ•°æ®...</div>';
            
            try {
                const components = await dataService.getComponentsSummary();
                
                previewArea.innerHTML = '';
                
                components.forEach(component => {
                    const card = document.createElement('div');
                    card.className = 'component-card';
                    
                    const statusClass = getStatusClass(component.matchPercentage);
                    
                    card.innerHTML = `
                        <h3>${component.componentName}</h3>
                        <div class="component-info">
                            <div>è¿˜åŸåº¦: <strong>${component.matchPercentage.toFixed(1)}%</strong></div>
                            <div>çŠ¶æ€: <span class="status ${statusClass}">${getStatusText(component.status)}</span></div>
                            <div>é—®é¢˜æ•°: ${component.issueCount}</div>
                            <div>æœ€åæ›´æ–°: ${new Date(component.lastUpdated).toLocaleString('zh-CN')}</div>
                            <div style="margin-top: 10px; font-size: 12px; color: #6b7280;">${component.description}</div>
                        </div>
                    `;
                    
                    previewArea.appendChild(card);
                });
                
            } catch (error) {
                previewArea.innerHTML = `<div style="color: #ef4444;">åŠ è½½å¤±è´¥: ${error.message}</div>`;
            }
        };
        
        window.clearResults = function() {
            document.getElementById('dataResults').textContent = 'ç»“æœå·²æ¸…é™¤';
            document.getElementById('imageResults').textContent = 'ç»“æœå·²æ¸…é™¤';
        };
        
        function getStatusClass(percentage) {
            if (percentage >= 95) return 'success';
            if (percentage >= 80) return 'warning';
            return 'error';
        }
        
        function getStatusText(status) {
            const statusMap = {
                excellent: 'ä¼˜ç§€',
                good: 'è‰¯å¥½',
                needs_improvement: 'éœ€æ”¹è¿›',
                poor: 'è¾ƒå·®',
                unknown: 'æœªçŸ¥',
                error: 'é”™è¯¯'
            };
            return statusMap[status] || status;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡ŒåŸºæœ¬æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¯ ç»„ä»¶è¿˜åŸåº¦å¯¹æ¯”ç³»ç»Ÿæµ‹è¯•é¡µé¢å·²åŠ è½½');
            
            // è‡ªåŠ¨åŠ è½½ç»„ä»¶é¢„è§ˆ
            setTimeout(() => {
                loadComponentsPreview();
            }, 1000);
        });
    </script>
</body>
</html>